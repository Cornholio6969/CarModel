<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:vm="clr-namespace:App.ViewModels"
        x:Class="App.MainWindow"
        mc:Ignorable="d"
        x:CompileBindings="False" 
        Width="1100" Height="720"
        Title="Corny"
        Background="White" Foreground="Black">
  <Window.DataContext>
    <vm:MainWindowViewModel/>
  </Window.DataContext>

  <Window.Styles>
    <Style Selector="TextBlock.h1">
      <Setter Property="FontSize" Value="36"/>
      <Setter Property="FontWeight" Value="SemiBold"/>
    </Style>
    <Style Selector="TextBlock.h2">
      <Setter Property="FontSize" Value="18"/>
      <Setter Property="Foreground" Value="#5A5A5A"/>
    </Style>
    <Style Selector="TextBox">
      <Setter Property="CornerRadius" Value="10"/>
      <Setter Property="Height" Value="40"/>
      <Setter Property="Margin" Value="0,6,0,14"/>
    </Style>
    <!-- Base button -->
  <Style Selector="Button.btn">
    <Setter Property="Height" Value="40"/>
    <Setter Property="MinWidth" Value="50"/>
    <Setter Property="CornerRadius" Value="10"/>
    <Setter Property="Padding" Value="16,0"/>
    <Setter Property="HorizontalContentAlignment" Value="Center"/>
    <Setter Property="VerticalContentAlignment" Value="Center"/>
    <Setter Property="Cursor" Value="Hand"/>
  </Style>

  <!-- Primary -->
  <Style Selector="Button.btn.primary">
    <Setter Property="Background" Value="{DynamicResource SystemAccentColor}"/>
    <Setter Property="Foreground" Value="White"/>
  </Style>
  <Style Selector="Button.btn.primary:pointerover">
    <Setter Property="Background" Value="{DynamicResource SystemAccentColorDark1}"/>
  </Style>

  <!-- Ghost -->
  <Style Selector="Button.btn.ghost">
    <Setter Property="Background" Value="#EFEFEF"/>
    <Setter Property="Foreground" Value="Black"/>
  </Style>
  <Style Selector="Button.btn.ghost:pointerover">
    <Setter Property="Background" Value="#E0E0E0"/>
  </Style>

  <!-- Outline -->
  <Style Selector="Button.btn.outline">
    <Setter Property="BorderBrush" Value="{DynamicResource SystemAccentColor}"/>
    <Setter Property="BorderThickness" Value="2"/>
    <Setter Property="Background" Value="Transparent"/>
    <Setter Property="Foreground" Value="{DynamicResource SystemAccentColor}"/>
  </Style>
  <Style Selector="Button.btn.outline:pointerover">
    <Setter Property="Background" Value="{DynamicResource SystemAccentColor}"/>
    <Setter Property="Foreground" Value="White"/>
  </Style>
    <Style Selector="Border.card">
      <Setter Property="Background" Value="White"/>
      <Setter Property="CornerRadius" Value="14"/>
      <Setter Property="Padding" Value="35"/>
      <Setter Property="BoxShadow" Value="0 6 18 0 #22000000"/>
    </Style>
    <Style Selector="Border.table-header">
      <Setter Property="Background" Value="#F3F4F6"/>
      <Setter Property="Padding" Value="12,10"/>
    </Style>
    <Style Selector="TextBlock.table-header-text">
      <Setter Property="FontWeight" Value="SemiBold"/>
    </Style>
  </Window.Styles>

  <Grid>
    <!-- Top bar -->
    <Border Background="{DynamicResource SystemAccentColor}" Height="56" VerticalAlignment="Top">
      <Grid ColumnDefinitions="*,Auto,*">
        <TextBlock Text="JS" VerticalAlignment="Center" Margin="24,0" Foreground="White" FontWeight="SemiBold"/>
        <TextBlock Text="Biler" Grid.Column="2" VerticalAlignment="Center" Margin="0,0,24,0" Foreground="White"/>
      </Grid>
    </Border>

    <!-- Content -->
    <ScrollViewer Margin="0,56,0,0">
      <Grid ColumnDefinitions="*,Auto,*">
        <StackPanel Grid.Column="1" MaxWidth="1500" Margin="28,28,28,36" Spacing="20">
          <Border Classes="card">
            <StackPanel Spacing="14">
              <TextBlock Classes="h1" Text="Corny"/>
              <TextBlock Classes="h2" Text="Creating car and CarBrand objects from a car and a CarBrand class"/>

              <!-- Form -->
              <Grid RowDefinitions="Auto,Auto,Auto,Auto,Auto" ColumnDefinitions="200,*" Margin="0,12,0,0" ColumnSpacing="18">
                <TextBlock Grid.Row="0" Grid.Column="0" VerticalAlignment="Center" Text="Bil brand"/>
                <TextBox Grid.Row="0" Grid.Column="1" Watermark="fx. BMW" Text="{Binding CarBrand}"/>

                <TextBlock Grid.Row="1" Grid.Column="0" VerticalAlignment="Center" Text="Bil Model"/>
                <TextBox Grid.Row="1" Grid.Column="1" Watermark="fx. 320d" Text="{Binding CarName}"/>

                <TextBlock Grid.Row="2" Grid.Column="0" VerticalAlignment="Center" Text="Bil Årgang"/>
                <TextBox Grid.Row="2" Grid.Column="1" Watermark="fx. 2018" Text="{Binding CarYear}"/>

                <TextBlock Grid.Row="3" Grid.Column="0" VerticalAlignment="Center" Text="Bil Pris"/>
                <TextBox Grid.Row="3" Grid.Column="1" Watermark="fx. 179.900" Text="{Binding CarPrice}"/>

                <StackPanel Grid.Row="4" Grid.Column="1" Orientation="Horizontal" Spacing="10" Margin="0,8,0,0">
                  <Button Classes="btn primary" Content="Tilføj / Gem" Command="{Binding AddOrSaveCommand}"/>
                  <Button Classes="btn ghost" Content="Nulstil" Command="{Binding ResetCommand}"/>
                  <TextBlock Text="|" VerticalAlignment="Center" Margin="2,0"/>
                  <!-- pass owner window as CommandParameter -->
                  <Button Classes="btn outline" Content="Hent fra nummerplade"
                          Command="{Binding LookupPlateCommand}"
                          CommandParameter="{Binding $parent[Window]}"/>
                </StackPanel>
              </Grid>

              <!-- Table (visual + per-row actions) -->
              <Grid Margin="0,16,0,0" RowDefinitions="Auto,Auto">
                <!-- Header -->
                <Grid ColumnDefinitions="*,*,*,*,160">
                  <Border Classes="table-header" Grid.Column="0"><TextBlock Classes="table-header-text" Text="Bil Model"/></Border>
                  <Border Classes="table-header" Grid.Column="1"><TextBlock Classes="table-header-text" Text="Bil Årgang"/></Border>
                  <Border Classes="table-header" Grid.Column="2"><TextBlock Classes="table-header-text" Text="Bil Pris"/></Border>
                  <Border Classes="table-header" Grid.Column="3"><TextBlock Classes="table-header-text" Text="Bil Brand"/></Border>
                  <Border Classes="table-header" Grid.Column="4"><TextBlock Classes="table-header-text" Text="Handlinger"/></Border>
                </Grid>

                <!-- Rows -->
                <ItemsControl Grid.Row="1" ItemsSource="{Binding Cars}">
                  <ItemsControl.ItemsPanel>
                    <ItemsPanelTemplate>
                      <StackPanel/>
                    </ItemsPanelTemplate>
                  </ItemsControl.ItemsPanel>
                  <ItemsControl.ItemTemplate>
                    <DataTemplate>
                      <Grid ColumnDefinitions="*,*,*,*,160" Height="40" VerticalAlignment="Center">
                        <TextBlock Grid.Column="0" Text="{Binding Name}" VerticalAlignment="Center"/>
                        <TextBlock Grid.Column="1" Text="{Binding Year}" VerticalAlignment="Center"/>
                        <TextBlock Grid.Column="2" Text="{Binding Price}" VerticalAlignment="Center"/>
                        <TextBlock Grid.Column="3" Text="{Binding Brand.Name}" VerticalAlignment="Center"/>
                        <StackPanel Grid.Column="4" Orientation="Horizontal" HorizontalAlignment="Left" Spacing="8">
                          <Button Classes="btn ghost" Content="Ret"
                                  Command="{Binding $parent[Window].DataContext.EditCommand}"
                                  CommandParameter="{Binding .}"/>
                          <Button Classes="btn outline" Content="Slet"
                                  Command="{Binding $parent[Window].DataContext.DeleteCommand}"
                                  CommandParameter="{Binding .}"/>
                        </StackPanel>
                      </Grid>
                    </DataTemplate>
                  </ItemsControl.ItemTemplate>
                </ItemsControl>
              </Grid>

              <!-- Counters -->
              <StackPanel Margin="0,8,0,0">
                <TextBlock Text="Tekniske Detaljer" FontWeight="SemiBold" Margin="0,8,0,4"/>
                <TextBlock Text="{Binding CarCount, StringFormat=Antal Bil objekter defineret: {0}}" />
                <TextBlock Text="{Binding CarBrandCount, StringFormat=Antal Bil brand objekter defineret: {0}}" />
              </StackPanel>
            </StackPanel>
          </Border>
        </StackPanel>
      </Grid>
    </ScrollViewer>
  </Grid>
</Window>
